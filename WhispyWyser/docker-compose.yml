version: '3.7'
services:
  whispywyser-gpu:
    container_name: whispywyser
    image: ghcr.io/cociweb/whispywyser_amd64-cuda:latest
    ports:
      - 10300:10300
    volumes:
      - whispywyser_data:/data
    restart: always
    command: --model custom --language hu --device cuda --beam-size 5 --compute-type float32 --custom_model_name "My customized Whisper model" --custom_model_url "https://huggingface.co/Hungarians/whisper-medium-cv16-hu/resolve/main/fp32/"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
  whispywyser-cpu:
    container_name: whispywyser
    image: ghcr.io/cociweb/whispywyser_amd64-cpu:latest
    ports:
      - 10300:10300
    volumes:
      - whispywyser_data:/data
    restart: always
    command: --model custom --language hu --device cpu --beam-size 1 --compute-type default --custom_model_name "My customized tiny Whisper model" --custom_model_url "https://huggingface.co/Hungarians/whisper-tiny-cv16-hu-v2/resolve/main/fp32/"
    deploy:
      resources:
        limits:
          cpus: "4.0"
          memory: 8096M


volumes:
  whispywyser_data: